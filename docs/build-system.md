# SASS-BEM - Система сборки

Часто возникает необходимость объявления правил сущности вне ее реализации. Например, объявление правил элемента для модификатора блока. В таком случае, если модификатор будет включен в сборку, а элемент - нет, в проекте будет лишний код для несуществующей сущности. Для решения этой проблемы и служит система сборки.

Когда мы объявляем сущность, на самом деле, помимо селектора добавляется placeholder-класс. Например, `+block(test)` выдаст селектор `.test%block--test`. Таким образом, в итоговом css-файле мы не увидим никакого блока `test`. Нам нужно выполнить extend placeholder-класса из пустого селектора, и тогда все заработает.

Мы можем легко сделать это с помощью миксина `build`. Он принимает `entity`, и на основе этого выполняет опциональный extend нужного класса. Например:

```
+block(test)
	display: flex
+build((block: test))
```

```
.test {display: flex}
```

Как правило, работая с БЭМ, в частности с классическим стеком, мы имеем возможность собрать проект по декларации. Всем этим автоматически занимается сборщик, например `gulp`. Все предельно просто: мы берем декларацию и преобразовываем ее в вызовы миксинов `build`, которые добавляем в итоговый файл(ы).

Таким образом, мы можем писать код на sass-bem так же, как и раньше, а система сборки исключит все ненужные сущности, вне зависимости от файлов, в которых они расположены. Например, наш sass-код выглядит так:

```
+block(test)
	+mod(state active)
		background-color: white
		+elem(inside)
			height: 10px
```

А декларация (bemdecl) следующая:

```
[
	{block: 'test'},
	{block: 'test', mod: 'state', val: 'active'}
]
```

Декларация будет преобразована к вызовам `build`, после чего произойдет компиляция sass в css, и мы получим следующее:

```
.test_state_active {background-color: white}
```

Элемента `inside` тут нет, т.к. его не было в декларации.

Конкретной реализацией системы сборки является этот же пакет, использованный в js-окружении (`require('sass-bem')`). Также существует gulp-плагин [gulp-sass-bem-build](https://github.com/IkorJefocur/gulp-sass-bem-build).